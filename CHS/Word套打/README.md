# Word套打工具

一个基于Python的Word模板批量替换工具，可以从Excel数据源读取数据，批量生成Word文档。

## 功能特点

- 支持选择Word模板文件（.docx格式）
- 支持选择Excel数据源文件（.xlsx/.xls格式）
- 自动读取Word中的标记（格式：`【标记名】`）
- 自动读取Excel中的所有列名
- 可为每个标记指定对应的Excel列
- 支持多Sheet选择
- 必须指定生成文件名所使用的列
- 批量生成Word文档，保持原有格式（包括下划线、字体、颜色等）
- 公式单元格读取计算结果而非公式本身

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 1. 准备Word模板

在Word文档中使用 `【标记名】` 格式插入需要替换的标记，例如：

```
姓名：【姓名】
性别：【性别】
年龄：【年龄】
```

**注意：** 标记可以应用任何格式（如加粗、下划线、字体颜色等），替换后会保留这些格式。

### 2. 准备Excel数据源

创建Excel文件，第一行为列名，从第二行开始为数据：

| 姓名 | 性别 | 年龄 | 部门 |
|------|------|------|------|
| 张三 | 男 | 25 | 技术部 |
| 李四 | 女 | 28 | 人事部 |

### 3. 运行程序

```bash
python word_mail_merge.py
```

### 4. 操作步骤

1. **选择Word模板文件** - 点击"选择Word模板"按钮，选择模板文件
2. **选择Excel数据文件** - 点击"选择Excel文件"按钮，选择数据源文件
3. **选择Sheet** - 从下拉框中选择要使用的Sheet
4. **配置标记映射** - 为每个Word标记指定对应的Excel列
   - 如果某标记不需要替换，选择"(不指定)"
5. **选择文件名列** - 从下拉框中选择用于生成输出文件名的列
6. **执行套打** - 点击"执行套打"按钮，选择输出文件夹
7. 等待程序处理完成

### 5. 输出结果

程序会在选择的输出文件夹中生成Word文档，文件名由指定的列值决定，每个数据行对应一个文件。

## 注意事项

1. **文件名列必须指定** - 必须选择一个列用于生成文件名
2. **标记格式** - 必须使用 `【】` 括起的中文标记
3. **模板格式保留** - 标记原有的格式（下划线、加粗、字体等）会被保留
4. **公式处理** - Excel中的公式会读取其计算结果，而非公式本身
5. **文件名非法字符** - 输出文件名中的非法字符会被自动替换为下划线
6. **空值处理** - 如果Excel单元格为空，会替换为空字符串

## 示例

### Word模板示例

```
员工信息表

姓名：【姓名】
性别：【性别】
年龄：【年龄】
部门：【部门】
联系电话：【电话】
```

### Excel数据示例

| 姓名 | 性别 | 年龄 | 部门 | 电话 |
|------|------|------|------|------|
| 张三 | 男 | 25 | 技术部 | 13800000001 |
| 李四 | 女 | 28 | 人事部 | 13800000002 |

### 输出结果

程序会生成两个Word文档：
- `张三.docx` - 包含张三的信息
- `李四.docx` - 包含李四的信息
